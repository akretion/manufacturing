<?xml version="1.0" encoding="UTF-8"?>
<openerp>
  <data>

<!-- mrp.workcenter-->

<record id="mrp_workcenter_view" model="ir.ui.view">
    <field name="model">mrp.workcenter</field>
    <field name="inherit_id" ref="mrp.mrp_workcenter_view"/>
    <field name="arch" type="xml">
        <field name="active" position="after">
            <field name="parent_id"/>
        </field>
        <xpath expr="//field[@name='time_stop']" position="after">
            <field name="day_capacity" string="Day Capacity"/>
        </xpath>
    </field>
</record>

<record id="mrp_workcenter_tree_view" model="ir.ui.view">
    <field name="model">mrp.workcenter</field>
    <field name="inherit_id" ref="mrp.mrp_workcenter_tree_view"/>
    <field name="arch" type="xml">
        <field name="name" position="replace">
            <button name="button_workcenter_line"
                    string="Click to see workcenter's operations"
                    icon="gtk-execute"
                    attrs="{'invisible': [('used', '=', False)]}"
                    type="object"
                    />
            <field name="hierachical_name"/>
        </field>
        <field name="resource_type" position="replace">
            <field name="global_load"/>
            <field name="day_capacity"/>
            <field name="availability"/>
            <field name="load"/>
            <field name="last_compute"/>
            <button name="toogle_used"
                    string="Click to connect => will be used in capacity computation"
                    icon="gtk-disconnect"
                    attrs="{'invisible': [('used', '=', True)]}"
                    type="object"/>
            <button name="toogle_used"
                    string="Click to disconnect => workcenters children will also be disconnected"
                    icon="gtk-connect"
                    attrs="{'invisible': [('used', '=', False)]}"
                    type="object"/>
            <field name="used" invisible="1"/>
        </field>
        <xpath expr="//tree[@ string='Work Center']" position="attributes">
            <attribute name="colors">red:global_load>0 and used==False;grey:used==False</attribute>
        </xpath>
    </field>
</record>

<menuitem
    id="menu_mrp_load"
    name="Load"
    parent="mrp.menu_mrp_planning"
    sequence="26" groups="base.group_no_one"/>

<menuitem
    action="mrp.mrp_workcenter_action"
    id="menu_mrp_workcenter_load_list"
    parent="menu_mrp_load"
    sequence="10" groups="base.group_no_one"/>


<record id="mrp_workcenter_view" model="ir.ui.view">
    <field name="model">mrp.workcenter</field>
    <field name="inherit_id" ref="mrp.mrp_workcenter_view"/>
    <field name="arch" type="xml">
        <xpath expr="//page[@string='General Information']" position="before">
            <page string="Work Orders">
                <group col="6">
                    <button name="button_order_workorders_in_workcenter"
                            string="Start Ordering"
                            class="oe_link"
                            icon="STOCK_REFRESH"
                            type="object"/>
                    <field name="production_line_order_by"/>
                    <!-- schedule_state_filter -->
                    <div>Filtered on Schedule: 'scheduled', 'pending'</div>
                    <button name="button_workcenter_line"
                            help="Workcenter list"
                            class="oe_link"
                            icon="gtk-execute"
                            type="object"
                            />
                </group>
                <field name="production_line_ids">
                    <tree>
                        <field name="sequence"/>
                        <field name="schedule_state"/>
                        <field name="date_planned_"/>
                        <field name="date_planned"/>
                        <field name="name"/>
                        <field name="product"/>
                        <field name="qty"/>
                        <field name="hour"/>
                        <field name="production_state"/>
                        <field name="production_id"/>
                        <field name="uom"/>
                    </tree>
                </field>
            </page>
        </xpath>
    </field>
</record>



<!-- mrp.production.workcenter.line -->

<record id="mrp_production_workcenter_tree_view_inherit" model="ir.ui.view">
    <field name="model">mrp.production.workcenter.line</field>
    <field name="inherit_id"
           ref="mrp_operations.mrp_production_workcenter_tree_view_inherit"/>
    <field name="arch" type="xml">
        <field name="workcenter_id" position="before">
            <field name="sequence"/>
            <field name="date_planned_"/>
            <button name="button_workcenter"
                    string="See Workcenter details"
                    icon="gtk-execute"
                    type="object"/>
        </field>
    </field>
</record>



<!-- After installation of the module, open the related menu -->
<record id="action_workcenter_load_module_install" model="ir.actions.client">
    <field name="name">Open Workcenter Load Menu</field>
    <field name="tag">reload</field>
    <field name="params"
           eval="{'menu_id': ref('menu_mrp_workcenter_load_list')}"/>
</record>
<record id="base.open_menu" model="ir.actions.todo">
    <field name="action_id" ref="action_workcenter_load_module_install"/>
    <field name="state">open</field>
</record>


  </data>
</openerp>
